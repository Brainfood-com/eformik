{"version":3,"sources":["../src/index.js"],"names":["React","PropTypes","withStyles","hoistNonReactStatics","Formik","Field","FormikField","connect","connectFormik","useField","useFormikContext","DoneIcon","SettingsBackupRestoreIcon","Button","TextField","IconButton","InputAdornment","formikTextFieldStyles","revertButton","eFormikContext","createContext","EFormikProvider","Provider","EFormikConsumer","Consumer","EFormikTextField","classes","name","props","eFormikCtx","useContext","type","value","onBlur","onChange","rawValue","error","touched","initialValue","isChanged","handleFieldReset","event","validateOnInitial","undefined","endAdornment","perFieldReset","color","formikButtonInfo","reset","handler","ev","formik","handleReset","enabled","dirty","submit","handleSubmit","isValid","isSubmitting","EFormikButton","info","handleOnClick","Component","oneOf","isRequired","EFormikRender","children","useState","initialMount","setInitialMount","validateForm","Children","only","EFormik","values","validateOnReset","onReset","then","component","render","handleOnReset","bool","withEFormik","formikProps","componentName","displayName","constructor","mapPropsToValues","key","mapPropsToStatus","Wrapped","initialValues","initialStatus"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport {withStyles} from '@material-ui/core/styles'\nimport hoistNonReactStatics from 'hoist-non-react-statics'\n\nimport {Formik, Field as FormikField, connect as connectFormik, useField, useFormikContext} from 'formik'\n\nimport DoneIcon from '@material-ui/icons/Done'\nimport SettingsBackupRestoreIcon from '@material-ui/icons/SettingsBackupRestore'\nimport Button from '@material-ui/core/Button'\nimport TextField from '@material-ui/core/TextField'\nimport IconButton from '@material-ui/core/IconButton'\nimport InputAdornment from '@material-ui/core/InputAdornment'\n\nconst formikTextFieldStyles = {\n  revertButton: {},\n}\n\nconst eFormikContext = React.createContext()\nconst {Provider: EFormikProvider, Consumer: EFormikConsumer} = eFormikContext\n\nexport const EFormikTextField = withStyles(formikTextFieldStyles)(({classes, name, ...props}) => {\n  const eFormikCtx = React.useContext(eFormikContext)\n  const [\n    {value, onBlur, onChange},\n    {value: rawValue, error, touched, initialValue},\n  ] = useField(name, props.type)\n  const isChanged = initialValue !== rawValue\n  function handleFieldReset(event) {\n    onChange(name)(initialValue)\n  }\n  return <TextField\n    {...props}\n    name={name}\n    value={value}\n    error={(eFormikCtx.validateOnInitial || touched) && error !== undefined}\n    helperText={error}\n    onChange={onChange}\n    onBlur={onBlur}\n    InputProps={{\n      endAdornment: eFormikCtx.perFieldReset && <InputAdornment position='end'>\n        <IconButton disabled={!isChanged} onClick={handleFieldReset} className={classes.revertButton}>\n          {isChanged ? <SettingsBackupRestoreIcon/> : <DoneIcon style={{color: 'green'}}/>}\n        </IconButton>\n      </InputAdornment>,\n    }}\n  />\n})\n\nconst formikButtonInfo = {\n  reset: {\n    handler: (ev, formik) => formik.handleReset(),\n    enabled: formik => formik.dirty,\n  },\n  submit: {\n    handler: (ev, formik) => formik.handleSubmit(ev),\n    enabled: formik => formik.isValid && !formik.isSubmitting,\n  },\n}\n\nexport const EFormikButton = connectFormik(class EFormikButton extends React.Component {\n  static propTypes = {\n    type: PropTypes.oneOf(['reset', 'submit']).isRequired,\n  }\n\n  handleOnClick = ev => {\n    const {formik, type} = this.props\n    const info = formikButtonInfo[type]\n    info.handler(ev, formik)\n  }\n\n  render() {\n    const {formik, type, ...props} = this.props\n    const info = formikButtonInfo[type]\n    return <Button {...props} type={type} onClick={this.handleOnClick} disabled={!info.enabled(formik)}/>\n  }\n})\n\nfunction EFormikRender(props) {\n  const {children} = props\n  const [initialMount, setInitialMount] = React.useState(true)\n\n  if (initialMount) {\n    setInitialMount(false)\n    const {validateOnInitial} = props\n    if (validateOnInitial) {\n      const formik = useFormikContext()\n      const {isValid, validateForm} = formik\n      if (!isValid) {\n        validateForm()\n      }\n    }\n  }\n  return React.Children.only(children)\n}\nclass EFormik extends React.Component {\n  static propTypes = {\n    validateOnInitial: PropTypes.bool,\n    validateOnReset: PropTypes.bool,\n    perFieldReset: PropTypes.bool,\n  }\n\n  static defaultProps = {\n    validateOnInitial: true,\n    validateOnReset: true,\n    perFieldReset: true,\n  }\n\n  handleOnReset = (values, formik) => {\n    const {validateOnReset, onReset} = this.props\n    if (validateOnReset) {\n      formik.validateForm().then(onReset)\n    } else {\n      onReset(values, formik)\n    }\n  }\n\n  render() {\n    const {perFieldReset, validateOnInitial, validateOnReset, component, render, children, onReset,  ...props} = this.props\n    const eFormikCtx = {perFieldReset, validateOnInitial, validateOnReset}\n    return <EFormikProvider value={eFormikCtx}>\n      <Formik {...props} onReset={this.handleOnReset}>\n        <EFormikRender validateOnInitial={validateOnInitial} children={children}/>\n      </Formik>\n    </EFormikProvider>\n  }\n}\n\nexport function withEFormik(formikProps) {\n  function componentName(Component) {\n    return Component.displayName || Component.name || (Component.constructor && Component.constructor.name) || 'Component'\n  }\n\n  const {\n    mapPropsToValues = props => Object.getOwnPropertyNames(props).reduce((values, key) => {\n      const {[key]: value} = props\n      if (typeof value !== 'function') {\n        values[key] = value\n      }\n      return values\n    }),\n    mapPropsToStatus = props => undefined,\n  } = formikProps\n  return Component => {\n    const Wrapped = props => {\n      const initialValues = mapPropsToValues(props)\n      const initialStatus = mapPropsToStatus(props)\n      return <EFormik {...formikProps} initialValues={initialValues} initialStatus={initialStatus}><Component {...props}/></EFormik>\n    }\n    Wrapped.displayName = 'EFormik(' + componentName(Component) + ')'\n    return hoistNonReactStatics(Wrapped, Component)\n  }\n}\n"],"file":"index.js"}